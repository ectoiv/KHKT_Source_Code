import numpy as np
import scipy.io as sio
import time
import os
import pandas as pd
import threading
import sys, io, atexit
log_dir = "logs"
os.makedirs(log_dir, exist_ok=True)
log_path = os.path.join(log_dir, f"rawlog_{time.strftime('%Y%m%d_%H%M%S')}.txt")
class Tee(io.TextIOBase):
    def __init__(self, *streams):
        self.streams=streams
    def write(self, data):
        for s in self.streams:
            s.write(data)
            s.flush()
        return len(data)
    def flush(self):
        for s in self.streams:
            s.flush()
_log_file = open(log_path, "a", buffering=1, encoding="utf-8")
_orig_stdout, _orig_stderr = sys.stdout, sys.stderr
sys.stdout = Tee(sys.stdout, _log_file)
sys.stderr = Tee(sys.stderr, _log_file)
print(f"Ghi log vô {log_path}")
@atexit.register
def _close_log():
    sys.stdout = _orig_stdout
    sys.stderr = _orig_stderr
    _log_file.close()
# Biến điều khiển bộ đếm
running = True

def timer_counter():
    start = time.perf_counter()
    while running:
        elapsed = time.perf_counter() - start
        print(f"\rThời gian: {elapsed:.10f} giây", end="\n", flush=True)
        time.sleep(1)

# Bắt đầu bộ đếm
thread = threading.Thread(target=timer_counter)
thread.start()

#### End Timer

# Number of topologies
ntopo = 28
nrelay = 42
Ifmax_all = [
[2883,	4861,	4383,	3346,	0,	    0,	    1081,	4168,	1457,	3951,	3395,	4582,	3535,	4832,	5004,	2072,	1770,	8063,	3613,	7702,	7886,	1806,	5074,	2596,	2149,	2192,	1925,	2347,	8019,	1642,	2672,	2059,	2626,	1617,	1942,	3718,	3691,	1406,	1426,	3556,	1920,	3725],
[3684,	4816,	4338,	3556,	3718,	1453,	1404,	4167,	0,   	0,	    3457,	4620,	2883,	4930,	4916,	2072,	1776,	8085,	3748,	7707,	7898,	1813,	5203,	2599,	2145,	2193,	1925,	2349,	8038,	1642,	2673,	2061,	2636,	1617,	1942,	3718,	3691,	1406,	1426,	3557,	1922,	3725],
[0,	    0,	    3561,	3820,	2883,	2522,	2383,	4074,	2742,	3977,	3731,	4635,	3788,	4914,	4248,	2073,	1740,	8099,	3977,	7697,	7907,	1813,	5203,	2599,	2119,	2192,	1920,	2349,	8047,	1640,	2672,	2061,	2635,	1617,	1937,	3718,	3690,	1406,	1426,	3557,	1922,	3725],
[3609,	4736,	4412,	2752,	3782,	1121,	0,	    0,	    1447,	4017,	2725,	4671,	3602,	4778,	4920,	2066,	1763,	7990,	3015,	7690,	7809,	1805,	5117,	2590,	2139,	2190,	1923,	2341,	7941,	1639,	2666,	2057,	2621,	1615,	1937,	3718,	3690,	1406,	1426,	3556,	1917,	3725],
[3987,	4863,	4374,	3739,	3734,	2453,	2423,	4045,	2836,	2883,	3791,	3613,	0,	    0,	    4997,	2072,	1769,	8078,	3954,	7689,	7911,	1774,	4241,	2598,	2149,	2192,	1925,	2346,	8035,	1640,	2673,	2052,	2596,	1616,	1942,	3718,	3691,	1406,	1426,	3556,	1913,	3725],
[3990,	3594,	0,	    0,	    3736,	2274,	2508,	2733,	2647,	3947,	2414,	4610,	3759,	4648,	3755,	2086,	1739,	7991,	2632,	7733,	7851,	1799,	4925,	2593,	2126,	2194,	1924,	2346,	7971,	1644,	2674,	2056,	2615,	1617,	1944,	3718,	3691,	1406,	1426,	3556,	1918,	3725],
[3937,	4596,	4349,	2410,	3707,	2312,	2504,	2703,	2594,	3946,	0,	    0,	    3813,	3650,	4716,	2068,	1756,	8034,	2595,	7735,	7805,	1790,	3959,	2613,	2131,	2192,	1922,	2347,	7976,	1643,	2669,	2059,	2622,	1618,	1939,	3718,	3691,	1406,	1426,	3557,	1922,	3725],
[3988,	4221,	3694,	3811,	3706,	2480,	2474,	4095,	2796,	3976,	3714,	4635,	3792,	4917,	0,	    0,	    853,	8080,	3939,	7354,	7620,	1806,	5202,	2572,	1244,	2175,	1708,	2318,	7824,	1556,	2565,	2053,	2620,	1601,	1709,	3716,	3643,	1404,	1418,	3552,	1902,	3721],
[3936,	4708,	4387,	2602,	3714,	2287,	2463,	2968,	2609,	3956,	2568,	4651,	3758,	4759,	4794,	2053,	1776,	7200,	0,	    0,	    7011,	1822,	4999,	2558,	2143,	2179,	1922,	2298,	7179,	1637,	2625,	2054,	2614,	1609,	1926,	3718,	3688,	1406,	1425,	3555,	1908,	3725],
[3990,	4869,	4375,	3750,	3732,	2475,	2475,	4097,	2803,	3934,	3780,	3901,	3790,	4219,	5000,	2054,	1765,	7754,	3942,	7304,	7923,	893,	0,	    0,	    2140,	2168,	1919,	2270,	7759,	1588,	2641,	1817,	1736,	1606,	1916,	3713,	3684,	1399,	1423,	3517,	1668,	3722],
[3992,	4684,	5024,	3797,	3726,	2487,	2479,	4129,	2808,	3976,	3755,	4634,	3794,	4917,	5024,	911,	0,	    0,	    3992,	7277,	7500,	1817,	5205,	2588,	940,	2246,	1666,	2374,	7542,	1612,	2663,	2060,	2621,	1183,	1734,	3718,	3649,	1406,	1420,	3557,	1923,	3723],
[3993,	4870,	4373,	3789,	3732,	2488,	2480,	4131,	2810,	3964,	3764,	4397,	3794,	4703,	5003,	2065,	1773,	7523,	3994,	7111,	0,	    0,	    5232,	969,	2139,	2193,	1926,	2346,	7368,	1626,	2692,	1549,	948,	1675,	1945,	3714,	3692,	1395,	1426,	3483,	1463,	3725],
[3991,	4739,	4244,	3788,	3727,	2484,	2479,	4112,	2805,	3976,	3738,	4634,	3793,	4916,	5002,	1290,	929,	8160,	3983,	7693,	7895,	1810,	5203,	2599,	0,	    0,	    1090,	2410,	7990,	1394,	2474,	2062,	2639,	1596,	1173,	3715,	3501,	1403,	1396,	3551,	1909,	3712],
[3993,	4868,	4370,	3786,	3732,	2487,	2480,	4127,	2809,	3976,	3754,	4634,	3794,	4918,	5004,	2027,	1696,	7613,	4004,	7311,	7423,	1775,	5206,	2586,	2181,	1614,	1971,	726,	0,	    0,	    1051,	2096,	2662,	1391,	1419,	3705,	3563,	1395,	1401,	3520,	1745,	3707],
[3992,	4868,	4374,	3770,	3732,	2483,	2479,	4111,	2806,	3970,	3752,	4535,	3793,	4815,	5000,	2073,	1769,	8009,	3987,	7631,	8017,	929,	5201,	1790,	2512,	2156,	1926,	2224,	7889,	1469,	2728,	881,	0,	    0,	    1918,	3698,	3680,	1365,	1421,	3313,	805,	3719],
[3993,	4859,	4359,	3786,	3732,	2487,	2480,	4128,	2809,	3976,	3757,	4627,	3794,	4910,	5007,	1917,	1568,	7758,	4003,	7475,	7734,	1769,	5204,	2536,	2204,	1100,	0,	    0,	    8149,	681,	1757,	2061,	2616,	1519,	907,	3734,	3425,	1414,	1394,	3555,	1804,	3727],
[3993,	4866,	4370,	3791,	3732,	2488,	2480,	4131,	2810,	3975,	3758,	4619,	3794,	4905,	5003,	2041,	1742,	8061,	4002,	7645,	7780,	1567,	5208,	2411,	2146,	2044,	1935,	1754,	8131,	1005,	0,	    0,	    2701,	888,	1785,	3726,	3673,	1397,	1430,	3451,	1246,	3738],
[3991,	4811,	4324,	3767,	3730,	2482,	2479,	4095,	2803,	3975,	3726,	4625,	3793,	4901,	4991,	1774,	1495,	7839,	3984,	7313,	7541,	1790,	5197,	2550,	2120,	1119,	840,	2337,	7886,	1217,	2218,	2059,	2605,	1581,	0,	    0,	    2883,	1419,	1304,	3569,	1862,	3701],
[3991,	4858,	4367,	3763,	3732,	2482,	2479,	4102,	2805,	3972,	3739,	4584,	3792,	4859,	4996,	2050,	1758,	7797,	3986,	7398,	7795,	1420,	5196,	2188,	2136,	2161,	1931,	2156,	7850,	1487,	2656,	1186,	2615,	751,	1892,	3701,	3702,	1304,	1438,	2883,	0,	    0   ],
[3993,	4869,	4373,	3791,	3732,	2488,	2480,	4131,	2810,	3976,	3759,	4633,	3794,	4917,	5002,	2065,	1761,	8108,	4001,	7710,	7922,	1804,	5205,	2593,	2151,	2135,	1859,	2356,	8063,	1638,	2666,	2022,	2639,	1584,	1957,	2883,	0,	    0,	    0,	    3578,	1934,	725 ],
[3993,	4869,	4373,	3791,	3732,	2488,	2480,	4131,	2810,	3976,	3759,	4633,	3794,	4917,	5002,	2065,	1761,	8108,	4001,	7710,	7922,	1804,	5205,	2593,	2151,	2135,	1859,	2356,	8063,	1638,	2666,	2022,	2639,	1584,	1957,	2883,	3713,	0,	    0,	    0,	    1934,	2883],
[1145,	4738,	3959,	3461,	875,	2434,	1646,	3984,	1929,	3953,	3322,	4593,	3642,	4823,	4468,	2066,	1743,	8040,	3554,	7679,	7849,	1804,	5082,	2593,	2119,	2190,	1919,	2343,	7983,	1637,	2666,	2057,	2623,	1615,	1934,	3718,	3690,	1406,	1426,	3556,	1917,	3725],
[3838,	4800,	4346,	3446,	3718,	1922,	1968,	3972,	2748,	1123,	3541,	4041,	941,	4812,	4914,	2069,	1764,	8037,	3652,	7677,	7870,	1780,	4517,	2592,	2141,	2190,	1923,	2342,	7991,	1638,	2669,	2052,	2598,	1615,	1939,	3718,	3691,	1406,	1426,	3556,	1912,	3725],
[3912,	2036,	1528,	3697,	3480,	2340,	2395,	3438,	2593,	3956,	3016,	4603,	3756,	4761,	2165,	2049,	1557,	7933,	3280,	7557,	7668,	1793,	5048,	2573,	1924,	2179,	1875,	2323,	7813,	1614,	2630,	2050,	2602,	1609,	1880,	3717,	3679,	1405,	1424,	3554,	1905,	3724],
[3941,	4733,	4346,	3120,	3717,	2299,	2408,	3501,	2678,	3643,	3673,	1789,	3734,	2084,	4864,	2056,	1754,	7855,	3352,	7558,	7774,	1613,	2367,	2571,	2127,	2181,	1918,	2316,	7816,	1622,	2650,	2006,	2417,	1609,	1925,	3717,	3687,	1404,	1425,	3548,	1861,	3724],
[3992,	4841,	4350,	3776,	3731,	2484,	2479,	4110,	2806,	3975,	3740,	4625,	3793,	4904,	4996,	1929,	1641,	7931,	3991,	7469,	7715,	1770,	5200,	2537,	2131,	1614,	1362,	2307,	7945,	1401,	2445,	2001,	2613,	1527,	1923,	858,	840,	1391,	600,	3518,	1868,	3300],
[3992,	4859,	4366,	3775,	3732,	2484,	2479,	4113,	2807,	3974,	3746,	4611,	3793,	4889,	4998,	2036,	1743,	7921,	3992,	7507,	7813,	1636,	5199,	2406,	2138,	2079,	1851,	2242,	7936,	1510,	2615,	1646,	2617,	1189,	1891,	3248,	3649,	523,	1410,	701,	1899,	866 ],
[3993,	4870,	4373,	3791,	3732,	2488,	2480,	4131,	2810,	3976,	3759,	4634,	3794,	4917,	5022,	2074,	1770,	8107,	4001,	7710,	7924,	1813,	5205,	2601,	2150,	2193,	1926,	2350,	8063,	1643,	2675,	2061,	2637,	1617,	1944,	3718,	3691,	1406,	1426,	3557,	1923,	3725],
]

Ifmin_all = [
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],
    [0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256, 0.5256],

]

relay_main_all = [
[2,	2,	3,	3,	4,	4,	4,	7,	8,	8,	8,	9 ,	10,	11,	11,	11,	12,	12,	13,	14,	14,	15,	15,	16,	16,	17,	17,	18,	18,	18,	19,	19,	19,	20,	20,	20,	21,	21,	21,	22,	22,	23,	23,	24,	24,	25,	25,	26,	26,	27,	27,	28,	28,	29,	29,	29,	30,	30,	31,	31,	32,	32,	33,	33,	34,	34,	35,	35,	36,	37,	38,	39,	40,	41,	41,	42],
[1,	2,	2,	3,	3,	4,	4,	4,	5,	6,	7,	8 ,	8 ,	8 ,	11,	11,	11,	12,	12,	14,	14,	15,	15,	16,	16,	17,	17,	18,	18,	18,	19,	19,	19,	20,	20,	20,	21,	21,	21,	22,	22,	23,	23,	24,	24,	25,	25,	26,	26,	27,	27,	28,	28,	29,	29,	29,	30,	30,	31,	31,	32,	32,	33,	33,	34,	34,	35,	35,	36,	37,	38,	39,	40,	41,	41,	42],
[3,	4,	4,	4,	6,	6,	7,	7,	8,	8,	8,	9 ,	9 ,	10,	11,	11,	11,	12,	12,	13,	14,	14,	15,	16,	16,	17,	17,	18,	18,	18,	19,	19,	19,	20,	20,	20,	21,	21,	21,	22,	22,	23,	23,	24,	24,	25,	25,	26,	26,	27,	27,	28,	28,	29,	29,	29,	30,	30,	31,	31,	32,	32,	33,	33,	34,	34,	35,	35,	36,	37,	38,	39,	40,	41,	41,	42],
[1,	2,	2,	3,	3,	4,  4,	5,	6,	9,	10,	11,	11,	12,	12,	13,	14,	14,	15,	15,	16,	16,	17,	17,	18,	18,	18,	19,	19,	20,	20,	20,	21,	21,	21,	22,	22,	23,	23,	24,	24,	25,	25,	26,	26,	27,	27,	28,	28,	29,	29,	29,	30,	30,	31,	31,	32,	32,	33,	33,	34,	34,	35,	35,	36,	37,	38,	39,	40,	41,	41,	42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 11, 11, 11, 12, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  5,  6,  6,  7,  7,  8,  8,  9,  9, 10, 11, 11, 12, 12, 13, 14, 14, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  5,  6,  6,  7,  7,  8,  8,  9,  9, 10, 13, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  5,  6,  6,  7,  7,  8,  8,  9,  9, 10, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 19, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 19, 20, 20, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 32, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 23, 23, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 35, 35, 36, 37, 38, 39, 40, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 29, 29, 29, 30, 31, 32, 32, 33, 33, 34, 34, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 29, 29, 29, 30, 33, 33, 34, 35, 35, 36, 37, 38, 39, 40, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 33, 33, 34, 35, 35, 36, 37, 38, 39],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 40, 41, 41],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 37, 41, 41],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
[1,  2,  2,  3,  3,  4,  4,  4,  5,  6,  6,  7,  7,  8,  8,  8,  9,  9, 10, 11, 11, 11, 12, 12, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 37, 38, 39, 40, 41, 41, 42],
]

I_coor_main_all = [
[4861, 4861, 4383, 4383, 3346, 3346, 3346, 1081, 4168, 4168, 4168, 1457, 3951, 3395, 3395, 3395, 4582, 4582, 3535, 4832, 4832, 5004, 5004, 2072, 2072, 1770, 1770, 8063, 8063, 8063, 3613, 3613, 3613, 7702, 7702, 7702, 7886, 7886, 7886, 1806, 1806, 5074, 5074, 2596, 2596, 2149, 2149, 2192, 2192, 1925, 1925, 2347, 2347, 8019, 8019, 8019, 1642, 1642, 2672, 2672, 2059, 2059, 2626, 2626, 1617, 1617, 1942, 1942, 3718, 3691, 1406, 1426, 3556, 1920, 1920, 3725],
[3684, 4816, 4816, 4338, 4338, 3556, 3556, 3556, 3718, 1453, 1404, 4167, 4167, 4167, 3457, 3457, 3457, 4620, 4620, 4930, 4930, 4916, 4916, 2072, 2072, 1776, 1776, 8085, 8085, 8085, 3748, 3748, 3748, 7707, 7707, 7707, 7898, 7898, 7898, 1813, 1813, 5203, 5203, 2599, 2599, 2145, 2145, 2193, 2193, 1925, 1925, 2349, 2349, 8038, 8038, 8038, 1642, 1642, 2673, 2673, 2061, 2061, 2636, 2636, 1617, 1617, 1942, 1942, 3718, 3691, 1406, 1426, 3557, 1922, 1922, 3725],
[3561, 3820, 3820, 3820, 2522, 2522, 2383, 2383, 4074, 4074, 4074, 2742, 2742, 3977, 3731, 3731, 3731, 4635, 4635, 3788, 4914, 4914, 4248, 2073, 2073, 1740, 1740, 8099, 8099, 8099, 3977, 3977, 3977, 7697, 7697, 7697, 7907, 7907, 7907, 1813, 1813, 5203, 5203, 2599, 2599, 2119, 2119, 2192, 2192, 1920, 1920, 2349, 2349, 8047, 8047, 8047, 1640, 1640, 2672, 2672, 2061, 2061, 2635, 2635, 1617, 1617, 1937, 1937, 3718, 3690, 1406, 1426, 3557, 1922, 1922, 3725],
[3609, 4736, 4736, 4412, 4412, 2752, 2752, 3782, 1121, 1447, 4017, 2725, 2725, 4671, 4671, 3602, 4778, 4778, 4920, 4920, 2066, 2066, 1763, 1763, 7990, 7990, 7990, 3015, 3015, 7690, 7690, 7690, 7809, 7809, 7809, 1805, 1805, 5117, 5117, 2590, 2590, 2139, 2139, 2190, 2190, 1923, 1923, 2341, 2341, 7941, 7941, 7941, 1639, 1639, 2666, 2666, 2057, 2057, 2621, 2621, 1615, 1615, 1937, 1937, 3718, 3690, 1406, 1426, 3556, 1917, 1917, 3725],
[3987, 4863, 4863, 4374, 4374, 3739, 3739, 3739, 3734, 2453, 2453, 2423, 2423, 4045, 4045, 4045, 2836, 2836, 3791, 3791, 3791, 3613, 4997, 4997, 2072, 2072, 1769, 1769, 8078, 8078, 8078, 3954, 3954, 3954, 7689, 7689, 7689, 7911, 7911, 7911, 1774, 1774, 4241, 2598, 2598, 2149, 2149, 2192, 2192, 1925, 1925, 2346, 2346, 8035, 8035, 8035, 1640, 1640, 2673, 2673, 2052, 2052, 2052, 2596, 2596, 1616, 1616, 1942, 1942, 3718, 3691, 1406, 1426, 3556, 1913, 1913, 3725],
[3990, 3594, 3736, 2274, 2274, 2508, 2508, 2733, 2733, 2647, 2647, 3947, 2414, 2414, 4610, 4610, 3759, 4648, 4648, 3755, 2086, 2086, 1739, 1739, 7991, 7991, 7991, 2632, 2632, 7733, 7733, 7733, 7851, 7851, 7851, 1799, 1799, 4925, 4925, 2593, 2593, 2126, 2126, 2194, 2194, 1924, 1924, 2346, 2346, 7971, 7971, 7971, 1644, 1644, 2674, 2674, 2056, 2056, 2615, 2615, 1617, 1617, 1944, 1944, 3718, 3691, 1406, 1426, 3556, 1918, 1918, 3725],
[3937, 4596, 4596, 4349, 4349, 2410, 2410, 3707, 2312, 2312, 2504, 2504, 2703, 2703, 2594, 2594, 3946, 3813, 3650, 4716, 4716, 2068, 2068, 1756, 1756, 8034, 8034, 8034, 2595, 2595, 7735, 7735, 7735, 7805, 7805, 7805, 1790, 1790, 3959, 2613, 2613, 2131, 2131, 2192, 2192, 1922, 1922, 2347, 2347, 7976, 7976, 7976, 1643, 1643, 2669, 2669, 2059, 2059, 2622, 2622, 1618, 1618, 1939, 1939, 3718, 3691, 1406, 1426, 3557, 1922, 1922, 3725,],
[3988, 4221, 3694, 3811, 3811, 3811, 3706, 2480, 2480, 2474, 2474, 4095, 4095, 4095, 2796, 2796, 3976, 3714, 3714, 3714, 4635, 4635, 3792, 4917, 4917, 853,  8080, 8080, 8080, 3939, 3939, 3939, 7354, 7354, 7354, 7620, 7620, 7620, 1806, 1806, 5202, 5202, 2572, 2572, 1244, 2175, 2175, 1708, 1708, 2318, 2318, 7824, 7824, 7824, 1556, 1556, 2565, 2565, 2053, 2053, 2620, 2620, 1601, 1601, 1709, 1709, 3716, 3643, 1404, 1418, 3552, 1902, 1902, 3721],
[3936, 4708, 4708, 4387, 4387, 2602, 2602, 3714, 2287, 2287, 2463, 2463, 2968, 2968, 2609, 2609, 3956, 2568, 2568, 4651, 4651, 3758, 4759, 4759, 4794, 4794, 2053, 2053, 1776, 1776, 7200, 7200, 7011, 7011, 1822, 1822, 4999, 4999, 2558, 2558, 2143, 2143, 2179, 2179, 1922, 1922, 2298, 2298, 7179, 7179, 1637, 1637, 2625, 2625, 2054, 2054, 2614, 2614, 1609, 1609, 1926, 1926, 3718, 3688, 1406, 1425, 3555, 1908, 1908, 3725],
[3990, 4869, 4869, 4375, 4375, 3750, 3750, 3750, 3732, 2475, 2475, 2475, 2475, 4097, 4097, 4097, 2803, 2803, 3934, 3780, 3780, 3780, 3901, 3790, 4219, 4219, 5000, 5000, 2054, 2054, 1765, 1765, 7754, 7754, 7754, 3942, 3942, 3942, 7304, 7304, 7304, 7923, 7923, 7923, 893,  2140, 2140, 2168, 2168, 1919, 1919, 2270, 2270, 7759, 7759, 7759, 1588, 1588, 2641, 2641, 1817, 1817, 1736, 1606, 1606, 1916, 1916, 3713, 3684, 1399, 1423, 3517, 1668, 1668, 3722],
[3992, 4684, 4684, 5024, 5024, 3797, 3797, 3797, 3726, 2487, 2487, 2479, 2479, 4129, 4129, 4129, 2808, 2808, 3976, 3755, 3755, 3755, 4634, 4634, 3794, 4917, 4917, 5024, 5024, 911,  3992, 3992, 3992, 7277, 7277, 7500, 7500, 1817, 1817, 5205, 5205, 2588, 2588, 940,  2246, 2246, 1666, 1666, 2374, 2374, 7542, 7542, 1612, 1612, 2663, 2663, 2060, 2060, 2621, 2621, 1183, 1183, 1734, 1734, 3718, 3649, 1406, 1420, 3557, 1923, 1923, 3723],
[3993, 4870, 4870, 4373, 4373, 3789, 3789, 3789, 3732, 2488, 2488, 2480, 2480, 4131, 4131, 4131, 2810, 2810, 3964, 3764, 3764, 3764, 4397, 4397, 3794, 4703, 4703, 5003, 5003, 2065, 2065, 1773, 1773, 7523, 7523, 3994, 3994, 3994, 7111, 7111, 5232, 5232, 969,  969,  2139, 2139, 2193, 2193, 1926, 1926, 2346, 2346, 7368, 7368, 1626, 1626, 2692, 2692, 1549, 1549, 948,  1675, 1675, 1945, 1945, 3714, 3692, 1395, 1426, 3483, 1463, 1463, 3725],
[3991, 4739, 4739, 4244, 4244, 3788, 3788, 3788, 3727, 2484, 2484, 2479, 2479, 4112, 4112, 4112, 2805, 2805, 3976, 3738, 3738, 3738, 4634, 4634, 3793, 4916, 4916, 5002, 5002, 1290, 929,  8160, 8160, 8160, 3983, 3983, 3983, 7693, 7693, 7693, 7895, 7895, 7895, 1810, 1810, 5203, 5203, 2599, 2599, 1090, 2410, 2410, 7990, 7990, 7990, 1394, 1394, 2474, 2474, 2062, 2062, 2639, 2639, 1596, 1596, 1173, 3715, 3501, 1403, 1396, 3551, 1909, 1909, 3712],
[3993, 4868, 4868, 4370, 4370, 3786, 3786, 3786, 3732, 2487, 2487, 2480, 2480, 4127, 4127, 4127, 2809, 2809, 3976, 3754, 3754, 3754, 4634, 4634, 3794, 4918, 4918, 5004, 5004, 2027, 2027, 1696, 1696, 7613, 7613, 4004, 4004, 4004, 7311, 7311, 7423, 7423, 1775, 1775, 5206, 5206, 2586, 2586, 2181, 2181, 1614, 1614, 1971, 1971, 726,  1051, 2096, 2096, 2662, 2662, 1391, 1391, 1419, 1419, 3705, 3563, 1395, 1401, 3520, 1745, 1745, 3707],
[3992, 4868, 4868, 4374, 4374, 3770, 3770, 3770, 3732, 2483, 2483, 2479, 2479, 4111, 4111, 4111, 2806, 2806, 3970, 3752, 3752, 3752, 4535, 4535, 3793, 4815, 4815, 5000, 5000, 2073, 2073, 1769, 1769, 8009, 8009, 8009, 3987, 3987, 3987, 7631, 7631, 7631, 8017, 8017, 8017, 929,  5201, 5201, 1790, 2512, 2512, 2156, 2156, 1926, 1926, 2224, 2224, 7889, 7889, 7889, 1469, 1469, 2728, 2728, 881,  1918, 1918, 3698, 3680, 1365, 1421, 3313, 805,  3719],
[3993, 4859, 4859, 4359, 4359, 3786, 3786, 3786, 3732, 2487, 2487, 2480, 2480, 4128, 4128, 4128, 2809, 2809, 3976, 3757, 3757, 3757, 4627, 4627, 3794, 4910, 4910, 5007, 5007, 1917, 1917, 1568, 1568, 7758, 7758, 7758, 4003, 4003, 4003, 7475, 7475, 7475, 7734, 7734, 7734, 1769, 1769, 5204, 5204, 2536, 2536, 2204, 2204, 1100, 8149, 8149, 8149, 681,  1757, 2061, 2061, 2616, 2616, 1519, 1519, 907,  3734, 3425, 1414, 1394, 3555, 1804, 1804, 3727],
[3993, 4866, 4866, 4370, 4370, 3791, 3791, 3791, 3732, 2488, 2488, 2480, 2480, 4131, 4131, 4131, 2810, 2810, 3975, 3758, 3758, 3758, 4619, 4619, 3794, 4905, 4905, 5003, 5003, 2041, 2041, 1742, 1742, 8061, 8061, 8061, 4002, 4002, 4002, 7645, 7645, 7645, 7780, 7780, 7780, 1567, 1567, 5208, 5208, 2411, 2411, 2146, 2146, 2044, 2044, 1935, 1935, 1754, 8131, 8131, 8131, 1005, 2701, 2701, 888,  1785, 1785, 3726, 3673, 1397, 1430, 3451, 1246, 3738],
[3991, 4811, 4811, 4324, 4324, 3767, 3767, 3767, 3730, 2482, 2482, 2479, 2479, 4095, 4095, 4095, 2803, 2803, 3975, 3726, 3726, 3726, 4625, 4625, 3793, 4901, 4901, 4991, 4991, 1774, 1774, 1495, 1495, 7839, 7839, 7839, 3984, 3984, 3984, 7313, 7313, 7313, 7541, 7541, 7541, 1790, 1790, 5197, 5197, 2550, 2550, 2120, 2120, 1119, 840,  2337, 2337, 7886, 7886, 7886, 1217, 1217, 2218, 2218, 2059, 2059, 2605, 2605, 1581, 1581, 1419, 1304, 3569, 1862, 1862, 3701],
[3991, 4858, 4858, 4367, 4367, 3763, 3763, 3763, 3732, 2482, 2482, 2479, 2479, 4102, 4102, 4102, 2805, 2805, 3972, 3739, 3739, 3739, 4584, 4584, 3792, 4859, 4859, 4996, 4996, 2050, 2050, 1758, 1758, 7797, 7797, 7797, 3986, 3986, 3986, 7398, 7398, 7398, 7795, 7795, 7795, 1420, 1420, 5196, 5196, 2188, 2188, 2136, 2136, 2161, 2161, 1931, 1931, 2156, 2156, 7850, 7850, 7850, 1487, 1487, 2656, 2656, 1186, 2615, 2615, 751,  1892, 1892, 3701, 3702, 1304, 1438],
[3993, 4869, 4869, 4373, 4373, 3791, 3791, 3791, 3732, 2488, 2488, 2480, 2480, 4131, 4131, 4131, 2810, 2810, 3976, 3759, 3759, 3759, 4633, 4633, 3794, 4917, 4917, 5002, 5002, 2065, 2065, 1761, 1761, 8108, 8108, 8108, 4001, 4001, 4001, 7710, 7710, 7710, 7922, 7922, 7922, 1804, 1804, 5205, 5205, 2593, 2593, 2151, 2151, 2135, 2135, 1859, 1859, 2356, 2356, 8063, 8063, 8063, 1638, 1638, 2666, 2666, 2022, 2022, 2639, 2639, 1584, 1584, 1957, 1957, 3578, 1934, 1934],
[3993, 4869, 4869, 4373, 4373, 3791, 3791, 3791, 3732, 2488, 2488, 2480, 2480, 4131, 4131, 4131, 2810, 2810, 3976, 3759, 3759, 3759, 4633, 4633, 3794, 4917, 4917, 5002, 5002, 2065, 2065, 1761, 1761, 8108, 8108, 8108, 4001, 4001, 4001, 7710, 7710, 7710, 7922, 7922, 7922, 1804, 1804, 5205, 5205, 2593, 2593, 2151, 2151, 2135, 2135, 1859, 1859, 2356, 2356, 8063, 8063, 8063, 1638, 1638, 2666, 2666, 2022, 2022, 2639, 2639, 1584, 1584, 1957, 1957, 3713, 1934, 1934],
[1145, 4738, 4738, 3959, 3959, 3461, 3461, 3461, 875,  2434, 2434, 1646, 1646, 3984, 3984, 3984, 1929, 1929, 3953, 3322, 3322, 3322, 4593, 4593, 3642, 4823, 4823, 4468, 4468, 2066, 2066, 1743, 1743, 8040, 8040, 8040, 3554, 3554, 3554, 7679, 7679, 7679, 7849, 7849, 7849, 1804, 1804, 5082, 5082, 2593, 2593, 2119, 2119, 2190, 2190, 1919, 1919, 2343, 2343, 7983, 7983, 7983, 1637, 1637, 2666, 2666, 2057, 2057, 2623, 2623, 1615, 1615, 1934, 1934, 3718, 3690, 1406, 1426, 3556, 1917, 1917, 3725],
[3838, 4800, 4800, 4346, 4346, 3446, 3446, 3446, 3718, 1922, 1922, 1968, 1968, 3972, 3972, 3972, 2748, 2748, 1123, 3541, 3541, 3541, 4041, 4041, 941,  4812, 4812, 4914, 4914, 2069, 2069, 1764, 1764, 8037, 8037, 8037, 3652, 3652, 3652, 7677, 7677, 7677, 7870, 7870, 7870, 1780, 1780, 4517, 4517, 2592, 2592, 2141, 2141, 2190, 2190, 1923, 1923, 2342, 2342, 7991, 7991, 7991, 1638, 1638, 2669, 2669, 2052, 2052, 2598, 2598, 1615, 1615, 1939, 1939, 3718, 3691, 1406, 1426, 3556, 1912, 1912, 3725],
[3912, 2036, 2036, 1528, 1528, 3697, 3697, 3697, 3480, 2340, 2340, 2395, 2395, 3438, 3438, 3438, 2593, 2593, 3956, 3016, 3016, 3016, 4603, 4603, 3756, 4761, 4761, 2165, 2165, 2049, 2049, 1557, 1557, 7933, 7933, 7933, 3280, 3280, 3280, 7557, 7557, 7557, 7668, 7668, 7668, 1793, 1793, 5048, 5048, 2573, 2573, 1924, 1924, 2179, 2179, 1875, 1875, 2323, 2323, 7813, 7813, 7813, 1614, 1614, 2630, 2630, 2050, 2050, 2602, 2602, 1609, 1609, 1880, 1880, 3717, 3679, 1405, 1424, 3554, 1905, 1905, 3724],
[3941, 4733, 4733, 4346, 4346, 3120, 3120, 3120, 3717, 2299, 2299, 2408, 2408, 3501, 3501, 3501, 2678, 2678, 3643, 3673, 3673, 3673, 1789, 1789, 3734, 2084, 2084, 4864, 4864, 2056, 2056, 1754, 1754, 7855, 7855, 7855, 3352, 3352, 3352, 7558, 7558, 7558, 7774, 7774, 7774, 1613, 1613, 2367, 2367, 2571, 2571, 2127, 2127, 2181, 2181, 1918, 1918, 2316, 2316, 7816, 7816, 7816, 1622, 1622, 2650, 2650, 2006, 2006, 2417, 2417, 1609, 1609, 1925, 1925, 3717, 3687, 1404, 1425, 3548, 1861, 1861, 3724],
[3992, 4841, 4841, 4350, 4350, 3776, 3776, 3776, 3731, 2484, 2484, 2479, 2479, 4110, 4110, 4110, 2806, 2806, 3975, 3740, 3740, 3740, 4625, 4625, 3793, 4904, 4904, 4996, 4996, 1929, 1929, 1641, 1641, 7931, 7931, 7931, 3991, 3991, 3991, 7469, 7469, 7469, 7715, 7715, 7715, 1770, 1770, 5200, 5200, 2537, 2537, 2131, 2131, 1614, 1614, 1362, 1362, 2307, 2307, 7945, 7945, 7945, 1401, 1401, 2445, 2445, 2001, 2001, 2613, 2613, 1527, 1527, 1923, 1923, 858,  840, 1391, 600, 3518, 1868, 1868, 3300],
[3992, 4859, 4859, 4366, 4366, 3775, 3775, 3775, 3732, 2484, 2484, 2479, 2479, 4113, 4113, 4113, 2807, 2807, 3974, 3746, 3746, 3746, 4611, 4611, 3793, 4889, 4889, 4998, 4998, 2036, 2036, 1743, 1743, 7921, 7921, 7921, 3992, 3992, 3992, 7507, 7507, 7507, 7813, 7813, 7813, 1636, 1636, 5199, 5199, 2406, 2406, 2138, 2138, 2079, 2079, 1851, 1851, 2242, 2242, 7936, 7936, 7936, 1510, 1510, 2615, 2615, 1646, 1646, 2617, 2617, 1189, 1189, 1891, 1891, 3248, 3649, 523, 1410, 701, 1899, 1899, 866],
[3993, 4870, 4870, 4373, 4373, 3791, 3791, 3791, 3732, 2488, 2488, 2480, 2480, 4131, 4131, 4131, 2810, 2810, 3976, 3759, 3759, 3759, 4634, 4634, 3794, 4917, 4917, 5022, 5022, 2074, 2074, 1770, 1770, 8107, 8107, 8107, 4001, 4001, 4001, 7710, 7710, 7710, 7924, 7924, 7924, 1813, 1813, 5205, 5205, 2601, 2601, 2150, 2150, 2193, 2193, 1926, 1926, 2350, 2350, 8063, 8063, 8063, 1643, 1643, 2675, 2675, 2061, 2061, 2637, 2637, 1617, 1617, 1944, 1944, 3718, 3691, 1406, 1426, 3557, 1923, 1923, 3725],
]

relay_back_all = [
[4,   16,  1,   16,  7,   12,  20,  10,  3,   12,  20,  8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   5,   3,   12,  20,  3,   7,   20,  13,  24,  11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[16,  7,   12,  20,  8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  12,  20,  2,   10,  5,   14,  3,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   3,   7,   20,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  27,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   16,  2,   8,   10,  5,   10,  12,  20,  5,   8,   14,  7,   20,  13,  24,  9,   11,  24,  1,   18,  26,  15,  26,  19,  22,  30,  7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   20,  2,   8,   10,  5,   10,  3,   20,  5,   8,   14,  9,   24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   17,  22,  30,  17,  19,  30,  23,  34,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   1,   7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  2,   8,   10,  5,   10,  3,   12,  5,   8,   14,  3,   7,   13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  22,  30,  17,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   26,  3,   7,   12,  22,  30,  19,  30,  23,  34,  11,  13,  21,  34,  15,  28,  36,  25,  36,  29,  32,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  30,  3,   7,   12,  17,  30,  11,  13,  7,   34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  27,  32,  27,  29,  33,  42,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  15,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  3,   7,   12,  17,  22,  17,  19,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  32,  27,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  11,  13,  21,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  42,  25,  28,  38,  35,  40,  37,  41,  31,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  36,  17,  19,  22,  32,  29,  33,  42,  21,  23,  31,  42,  25,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  17,  19,  22,  27,  21,  23,  42,  25,  28,  38,  35,  40,  37,  41,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  25,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  21,  23,  31,  25,  28,  38,  35,  40,  37],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  41,  31,  33],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  35,  31,  33],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
[6,   4,   16,  1,   16,  7,   12,  20,  2,   8,   10,  5,   10,  3,   12,  20,  5,   8,   14,  3,   7,   20,  13,  24,  9,   11,  24,  1,   4,   18,  26,  15,  26,  19,  22,  30,  3,   7,   12,  17,  22,  30,  17,  19,  30,  23,  34,  11,  13,  21,  34,  15,  18,  28,  36,  25,  36,  29,  32,  17,  19,  22,  27,  32,  27,  29,  33,  42,  21,  23,  31,  42,  25,  28,  38,  35,  40,  37,  41,  31,  33,  39],
]

I_coor_back_all = [
[1330,  699,  837,  699,  673,  1446,  1228, 1081,  1494,  1446,  1228,  1457,  1097,  1494,  673,  1228, 986,   749,  676,  1247,  749,  837,  1330,  1225,  846,  923,  846,  957,  768,  633,  1494,  673,  1446,  588,  768,  633,  588,  957,  633,  918,  888,  1247,  986,   1708,  888,  923,  1225,  1105,  1088,  838,  1088,  1689,  658,  588,  957,  768,  984,  658,  984,  1689,  1181,  878,  1708,  918,  739,  878,  838,  1105,  858,  839,  1406,  1426,  701,  739,  1181,  866],
[830,  1283,  698,  792,  698,  809,   1519, 1226,  860,   1453,  1404,  1420,  1519,  1228,  1420, 809,  1228,  1020, 754,  1345,  754,  792,  1283,  1225,  847,  919,  847,  972,  777,  634,  1420,  809,  1519,  585,  777,  634,  585,  972,  634,  925,  888,  1345,  1020,  1711,  888,  919,  1225,  1105,  1088,  837,  1088,  169,   659,  585,  972,  777,  983,  659,  983,  1690,  1183,  878,  1711,  925,  739,  878,  837,  1105,  858,  839,  1406,  1426,  701,  739,  1183,  866],
[703,  1127,  1470, 1224, 1442, 1080,  1304, 1080,  1381,  1470,  1224,  1304,  1442,  1124,  1381, 1127, 1224,  1038, 753,  934,  1328,  753,  1407,  1226,  847,  893,  847,  990,  775,  632,  1381,  1127, 1470,  578,  776,  632,  578,  990,  632,  924,  888,  1328,  1038,  1711,  888,  893,  1226,  1105,  1088,  832,  1088,  1690,  659,  578,  990,  775,  982,  659,  982,  1690,  1138,  878,  1711,  924,  739,  878,  832,  1105,  858,  838,  1406,  1426,  701,  739,  1183,  866],
[750,  1208,  693,  876,  693,  1521,  1231, 928,   1121,  1447,  1166,  1494,  1231,  1082,  746,  742,  1197,  746,  876,  1208, 1221,  845,  917,   845,   887,  766,  631,  1494, 1521, 580,  766,   631,  580,   887,  631,  918,  887,  1197, 1082, 1703, 887,  917,   1221,  1102,  1088, 835,  1088,  1684,  657,   580,  887,   766,   982,  657,  982,  1684, 1179, 878,  1703, 918,   738,   878,  835,   1102, 857,  838,  1406, 1426,  700,  738,  1179,  865],
[1138, 1330,  699,  830,  699,  1131,  1386, 1223, 876,  1434, 1020, 1403, 1020, 1438, 1386, 1223, 1403, 1434, 1438, 1131, 1223,  757,  830, 1330, 1226,  846,  923,  846,  985,  757,  632, 1438, 1131, 1386,  587,  757,  632,  587,  985,  635,  886,  888, 1399, 1710,  888,  923, 1226, 1104, 1088,  838, 1088, 1689,  657,  587,  985,  757,  984,  657,  984, 1689,  299, 1174,  878, 1710,  886,  739,  878,  838, 1104,  857,  839, 1406, 1426,  700,  739, 1174,  866],
[1144, 740,   877,  1207, 1068, 1441,  1068, 1476, 1257, 1441, 1207, 1092, 1156, 1257, 1019,  747,  905, 1065,  747,  898, 1236,  850,  889,  850,  884,  762,  641, 1156, 1476,  620,  762,  641,  620,  884,  641,  911,  888, 1065, 1019, 1705,  888,  889, 1236, 1107, 1088,  837, 1088, 1688,  658,  620,  884,  762,  986,  658,  986, 1688, 1179,  878, 1705,  911,  739,  878,  837, 1107,  858,  840, 1406, 1426,  701,  739, 1179,  866],
[1088, 1065,  694,  809,  694,  1151,  1259, 848,  1197, 1116, 1389, 1116, 1444, 1259, 1389, 1197, 1089,  963,  798,  809, 1065, 1222,  846,  910,  846,  883,  812,  637, 1444, 1151,  576,  812,  637,  576,  883,  637,  899,  891, 1103, 1723,  891,  910, 1222, 1104, 1088,  834, 1088, 1687,  660,  576,  883,  812,  982,  660,  982, 1687, 1182,  878, 1723,  899,  740,  878,  834, 1104,  858,  839, 1406, 1426,  701,  740, 1182,  866],
[1140, 1378,  832,  1092, 1472, 1248,  846,  1402, 1079, 1395, 1079, 1376, 1472, 1248, 1395, 1402, 1123, 1376, 1092, 1248, 1036,  755,  393, 1328,  755,  853, 1047,  771,  562, 1376, 1092, 1472,  300,  771,  562,  300, 1047,  562,  927,  879, 1328, 1036, 1693,  879, 1244, 1088, 1088,  620, 1088, 1664,  655,  300, 1047,  771,  901,  655,  901, 1664, 1177,  876, 1693,  927,  725,  876,  620, 1088,  855,  788, 1404, 1418,  696,  725, 1177,  861],
[1085,  1141,  732,  811,  732, 1101, 1501,  855, 1217, 1070, 1392, 1070, 1467, 1501, 1392, 1217, 1101, 1467, 1101, 1020,  788,  903, 1136,  788,  811, 1141, 1210,  842,  933,  842,  828,  653,  632,  653,  940,  883, 1136, 1020, 1675,  883,  933, 1210, 1091, 1088,  835, 1088, 1643,  655,  632,  828,  982,  655,  982, 1643, 1176,  878, 1675,  940,  732,  878,  835, 1091,  857,  836, 1406, 1425,  699,  732, 1176,  865],
[1142, 1334,  702,  828,  702, 1092, 1410, 1249,  875, 1403, 1073, 1402, 1073, 1440, 1410, 1249, 1402, 1403, 1077, 1440, 1092, 1249, 1040,  937, 1376,  753,  828, 1334, 1215,  839,  926,  839, 1051,  414,  582, 1440, 1092, 1410,  587,  414,  582,  587, 1051,  582,  893,  926, 1215, 1082, 1086,  834, 1086, 1662,  608,  587, 1051,  414,  980,  608,  980, 1662,  939,  878, 1736,  728,  878,  834, 1082,  852,  831, 1399, 1423,  659,  728,  939,  863],
[1144, 1358,  491,  830,  491, 1096, 1469, 1233,  868, 1409, 1079, 1401, 1079, 1428, 1469, 1233, 1401, 1409, 1123, 1428, 1096, 1233, 1037,  753,  941, 1331,  753,  830, 1358,  911, 1428, 1096, 1469,  800,  758, 1030,  758,  925,  892, 1331, 1037, 1696,  892,  940, 1157, 1089,  577, 1088, 1713,  661, 1030,  800,  950,  661,  950, 1713, 1183,  878, 1696,  925,  740,  878,  577, 1157,  858,  796, 1406, 1420,  702,  740, 1183,  864],
[1145, 1337,  700,  828,  700, 1096, 1462, 1232,  875, 1409, 1079, 1402, 1079, 1436, 1469, 1232, 1402, 1409, 1110, 1436, 1096, 1232, 1039,  511,  941, 1358,  511,  829, 1337, 1227,  849,  924,  847, 1038,  774, 1437, 1096, 1462,  614,  774, 1358, 1039,  969,  969,  924, 1216, 1106, 1088,  839, 1088, 1706,  640,  614, 1038,  985,  640,  985, 1706,  669,  880,  948,  795,  880,  839, 1106,  853,  840, 1395, 1426,  626,  795,  669,  866],
[1143,  1336,  567,  828,  567,  1096, 1469, 1224, 869,  1409, 1079, 1400, 1079, 1419, 1469, 1224, 1400, 1406, 1123, 1419, 1095, 1224, 1036, 754,  940,  1328, 754,  828,  1336, 1290, 929,  990,  783,  686,  1419, 1095, 1469, 511,  783,  686,  511,  990,  686,  925,  885,  1328, 1036, 1714, 885,  1090, 1745, 665,  511,  990,  783,  729,  665,  729,  1745, 1187, 875,  1714, 925,  721,  845,  1173, 854,  643,  1403, 1396, 695,  721,  1187, 851],
[1145,  1338,  696,  829,  696,  1096, 1469, 1220, 875,  1409, 1079, 1402, 1079, 1438, 1469, 1220, 1402, 1409, 1123, 1438, 1096, 1220, 1037, 753,  941,  1331, 753,  829,  1338, 1256, 771,  925,  771,  1008, 894,  1438, 1096, 1469, 699,  894,  699,  1008, 925,  849,  1331, 1037, 1736, 849,  925,  1256, 531,  1083, 889,  1083, 726,  1051, 1225, 871,  1736, 925,  520,  871,  889,  531,  844,  708,  1395, 1401, 663,  520,  1225, 847],
[1144,  1334,  700,  828,  700,  1095, 1454, 1220, 875,  1406, 1078, 1402, 1078, 1437, 1454, 1220, 1402, 1406, 1116, 1437, 1095, 1220, 1036, 652,  940,  1327, 652,  828,  1334, 1228, 845,  924,  845,  988,  592,  725,  1437, 1095, 1454, 601,  592,  725,  601,  988,  725,  929,  1327, 1036, 1790, 924,  1228, 1074, 1082, 844,  1082, 1742, 483,  601,  988,  592,  986,  483,  986,  1742, 881,  844,  1074, 836,  827,  1365, 1421, 449,  805,  859],
[1145,  1341,  685,  829,  685,  1096, 1467, 1222, 875,  1409, 1079, 1402, 1079, 1439, 1467, 1222, 1402, 1409, 1122, 1439, 1096, 1222, 1036, 746,  941,  1330, 746,  829,  1341, 1276, 641,  928,  641,  1002, 735,  312,  1439, 1096, 1467, 712,  735,  312,  712,  1002, 312,  925,  844,  1330, 1036, 1691, 844,  928,  1276, 1100, 712,  1002, 735,  681,  1757, 1173, 888,  1691, 925,  631,  888,  907,  566,  566,  1414, 1394, 700,  631,  1173, 867],
[1145,  1337,  696,  829,  696,  1096, 1469, 1226, 875,  1409, 1079, 1402, 1079, 1436, 1469, 1226, 1402, 1409, 1122, 1436, 1096, 1226, 1037, 738,  941,  1334, 738,  829,  1337, 1222, 818,  924,  818,  998,  860,  501,  1436, 1096, 1469, 572,  860,  501,  572,  998,  501,  928,  639,  1334, 1037, 1773, 639,  924,  1222, 947,  1098, 838,  1098, 1754, 572,  998,  860,  1005, 1773, 928,  888,  838,  947,  866,  821,  1397, 1430, 593,  1246, 879],
[1142,  1326,  648,  828,  648,  1095, 1465, 1207, 872,  1404, 1078, 1401, 1078, 1424, 1465, 1207, 1401, 1404, 1121, 1434, 1095, 1207, 1036, 744,  940,  1322, 744,  828,  1326, 1199, 574,  921,  574,  984,  751,  397,  1424, 1095, 1465, 444,  751,  397,  444,  984,  397,  922,  867,  1322, 1036, 1683, 867,  921,  1199, 1119, 840,  1669, 668,  444,  984,  751,  549,  668,  549,  1669, 1170, 890,  1683, 922,  692,  890,  1419, 1304, 715,  692,  1170, 837],
[1143,  1330,  694,  828,  694,  1095, 1457, 1211, 874,  1405, 1078, 1401, 1078, 1434, 1457, 1211, 1401, 1405, 1119, 1434, 1095, 1211, 1036, 702,  939,  1321, 702,  828,  1330, 1214, 837,  922,  837,  985,  579,  523,  1434, 1095, 1457, 577,  579,  523,  577,  985,  523,  923,  497,  1321, 1036, 1692, 497,  922,  1214, 1061, 1100, 831,  1100, 1663, 493,  577,  985,  579,  994,  493,  994,  1663, 1186, 1692, 923,  751,  831,  1061, 837,  851,  1304, 1438],
[1145,  1337,  699,  828,  699,  1096, 1469, 1226, 875,  1409, 1079, 1402, 1079, 1436, 1469, 1226, 1402, 1409, 1123, 1436, 1096, 1226, 1037, 753,  941,  1331, 753,  828,  1337, 1227, 838,  923,  838,  995,  777,  634,  1436, 1096, 1469, 587,  777,  634,  587,  995,  634,  925,  879,  1331, 1037, 1714, 879,  923,  1227, 1117, 1020, 840,  1020, 1692, 664,  587,  995,  777,  974,  664,  974,  1692, 1186, 837,  1714, 925,  748,  837,  840,  1117, 725,  748,  1186],
[1145,  1337,  699,  828,  699,  1096, 1469, 1226, 875,  1409, 1079, 1402, 1079, 1436, 1469, 1226, 1402, 1409, 1123, 1436, 1096, 1226, 1037, 753,  941,  1331, 753,  828,  1337, 1227, 838,  923,  838,  995,  777,  634,  1436, 1096, 1469, 587,  777,  634,  587,  995,  634,  925,  879,  1331, 1037, 1714, 879,  923,  1227, 1117, 1020, 840,  1020, 1692, 664,  587,  995,  777,  974,  664,  974,  1692, 1186, 837,  1714, 925,  748,  837,  840,  1117, 864,  748,  1186],
[1145,  1210,  693,  417,  693,  790,  1451, 1220, 875,  1359, 1076, 570,  1076, 1313, 1451, 1220, 570,  1359, 1099, 1313, 790,  1220, 1000, 747,  785,  1239, 747,  417,  1210, 1221, 845,  898,  845,  938,  765,  628,  1313, 790,  1451, 570,  765,  628,  570,  938,  628,  917,  887,  1239, 1000, 1706, 887,  898,  1221, 1102, 1088, 831,  1088, 1686, 657,  570,  938,  765,  980,  657,  980,  1686, 1180, 878,  1706, 917,  738,  878,  831,  1102, 857,  837,  1406, 1426, 700,  738,  1180, 865],
[986,   1268,  694,  804,  694,  898,  1330, 1219, 859,  1351, 571,  1398, 571,  1424, 1330, 1219, 1398, 1351, 1123, 1424, 898,  1219, 445,  747,  941,  1229, 747,  804,  1268, 1223, 845,  918,  845,  948,  751,  629,  1424, 898,  1330, 581,  751,  629,  581,  948,  629,  893,  887,  1229, 445,  1705, 887,  918,  1223, 1103, 1088, 836,  1088, 1686, 656,  581,  948,  751,  982,  656,  982,  1686, 1174, 878,  1705, 893,  738,  878,  836,  1103, 857,  838,  1406, 1426, 700,  738,  1174, 865],
[1062,  1337,  700,  828,  700,  1039, 1461, 1197, 621,  1270, 1071, 1325, 1071, 780,  1461, 1197, 1325, 1270, 1101, 780,  1039, 1197, 1020, 737,  900,  1187, 737,  828,  1337, 1208, 841,  716,  841,  867,  754,  605,  780,  1039, 1461, 482,  754,  605,  482,  867,  605,  911,  882,  1187, 1020, 1691, 882,  716,  1208, 1092, 1088, 788,  1088, 1670, 654,  482,  867,  754,  960,  654,  960,  1670, 1173, 877,  1691, 911,  732,  877,  788,  1092, 856,  826,  1405, 1424, 698,  732,  1173, 864],
[1090,  1210, 686,  813, 686,  1048, 875,  1197, 858,  1285, 1015, 1394, 1015, 1429, 875,  1197, 1394, 1285, 788,  1429, 1048, 1197, 1037, 753,  880,  1331, 753,  813,  1210, 1215, 841,  912,  841,  877,  656,  613,  1429, 1048, 875,  572,  656,  613,  572,  877,  613,  730,  884,  1331, 1037, 1688, 884,  912,  1215, 1094, 1087, 831,  1087, 1672, 644,  572,  877,  656,  978,  644,  978,  1672, 1129, 878,  1688, 730,  732,  878,  831,  1094, 856,  832,  1404, 1425, 691,  732,  1129, 864],
[1143,  1330, 675,  828, 675,  1096, 1465, 1215, 873,  1406, 1078, 1401, 1078, 1430, 1465, 1215, 1401, 1406, 1122, 143,  1096, 1215, 1036, 744,  940,  1325, 744,  828,  1330, 1210, 719,  922,  719,  988,  734,  499,  1430, 1096, 1465, 514,  734,  499,  514,  988,  499,  923,  847,  1325, 1036, 1690, 847,  922,  1210, 1087, 527,  836,  527,  1675, 632,  514,  988,  734,  770,  632,  770,  1675, 1171, 830,  1690, 923,  697,  830,  836,  1087, 858,  840,  1391, 600,  661,  697,  1171, 435],
[1144,  1332, 692,  828, 692,  1096, 1463, 1217, 874,  1407, 1078, 1401, 1078, 1434, 1463, 1217, 1401, 1407, 1121, 1434, 1096, 1217, 1036, 729,  940,  1325, 729,  828,  1332, 1215, 821,  922,  821,  989,  674,  548,  1434, 1096, 1463, 564,  674,  548,  564,  989,  548,  923,  712,  1325, 1036, 1694, 712,  922,  1215, 1060, 1020, 831,  1020, 1674, 568,  564,  989,  674,  941,  568,  941,  1674, 1178, 468,  1694, 923,  721,  468,  831,  1060, 381,  795,  523,  1410, 701,  721,  1178, 866],
[1145,  1337, 700,  828, 700,  1096, 1469, 1226, 875,  1409, 1079, 1402, 1079, 1436, 1469, 1226, 1402, 1409, 1123, 1436, 1096, 1226, 1037, 753,  941,  1331, 753,  828,  1337, 1227, 847,  923,  847,  995,  776,  635,  1436, 1096, 1469, 588,  776,  635,  588,  995,  635,  925,  889,  1331, 1037, 1712, 889,  923,  1227, 1106, 1088, 838,  1088, 1691, 659,  588,  995,  776,  984,  659,  984,  1691, 1183, 878,  1712, 925,  740,  878,  838,  1106, 858,  840,  1406, 1426, 701,  740,  1183, 866],

]
# === Initialization ===s
def initialization(nP, dim, ub, lb):
    ub_arr = np.array(ub).reshape(-1)
    lb_arr = np.array(lb).reshape(-1)
    if ub_arr.size == 1:
        return np.random.rand(nP, dim) * (ub_arr - lb_arr) + lb_arr
    else:
        pop = np.zeros((nP, dim))
        for i in range(dim):
            pop[:, i] = np.random.rand(nP) * (ub_arr[i] - lb_arr[i]) + lb_arr[i]
        return pop

# === Trip function ===
def trip(Ifmax, Ikd, coeff):
    if Ifmax == 0 or Ikd <= 0 or coeff <= 0:
        return 0.0
    ratio = Ifmax / (coeff * Ikd)

    if ratio < 20:
        base_time = 13.5 / (ratio - 1)
    else:
        base_time = 13.5 / 19.0  # floor

    return base_time

# === Objective Function (OF) ===
def OF(x, it, Ifmax, relay_main, I_coor_main, relay_back, I_coor_back, MaxIt,coeffs):
    dim = len(x)
    nrelay = dim // 2
    TMS = x[:nrelay]
    PS = x[nrelay:]

    ntopo_in_group = len(Ifmax) // nrelay
    avg_t = []
    for i in range(ntopo_in_group):
        t_i = []
        active = 0
        for j in range(nrelay):
            idx = i * nrelay + j
            t_val = TMS[j] * trip(Ifmax[idx], PS[j], coeffs[j])
            if t_val != 0:
                active += 1
            t_i.append(t_val)
        avg_t.append(sum(t_i) / active if active > 0 else 0)
    f = sum(avg_t)

    # backup coordination penalty
    Kp = 10.0
    delta_t = []
    for k, main_idx in enumerate(relay_main):
        back_idx = relay_back[k]
        t_back = TMS[back_idx-1] * trip(I_coor_back[k], PS[back_idx-1], coeffs[back_idx-1])
        t_main = TMS[main_idx-1] * trip(I_coor_main[k], PS[main_idx-1], coeffs[main_idx-1])
        delta_t.append(t_back - t_main)
    delta_t = np.array(delta_t)
    violations = delta_t < 0.2
    CTIcon = np.sum((delta_t[violations] - 0.2)**2)
    n_fail = np.sum(violations)
    beta = 1 - 0.99**it

    f += Kp * beta * (CTIcon + n_fail)
    return f

# === Comprehensive Opposition (CO) Phase ===
def apply_CO(pop, iter, MaxIt, LB, UB):
    N, dim = pop.shape
    c = 0.5 * (LB + UB)
    ratio = iter / MaxIt
    if ratio <= 0.224:
        Preo, Pqr, Pqo = 0.01, 0.01, 0.54 + 1.92 * ratio
    elif ratio > 0.723:
        Preo, Pqr, Pqo = 0.01, 0.97, 0.01
    else:
        Preo = 0.01
        Pqr = -0.42 + 1.92 * ratio
        Pqo = 1.4 - 1.92 * ratio
    new_pop = np.zeros_like(pop)
    for i in range(N):
        x = pop[i].copy()
        x_op = LB + UB - x
        r = np.random.rand()
        if r < Preo:
            xo = np.where(x < c,
                          np.random.rand(dim) * (UB - x_op) + x_op,
                          np.random.rand(dim) * (x_op - LB) + LB)
            chosen = LB + UB - xo
        elif r < Preo + Pqr:
            xo = np.where(x < c,
                          np.random.rand(dim) * (c - x) + x,
                          np.random.rand(dim) * (x - c) + c)
            chosen = xo
        elif r < Preo + Pqr + Pqo:
            xo = np.where(x < c,
                          np.random.rand(dim) * (x_op - c) + c,
                          np.random.rand(dim) * (c - x_op) + x_op)
            chosen = xo
        else:
            xo = np.where(x < c,
                          np.random.rand(dim) * (UB - x_op) + x_op,
                          np.random.rand(dim) * (x_op - LB) + LB)
            chosen = xo
        new_pop[i] = np.clip(chosen, LB, UB)
    return new_pop

# === Helpers ===
def random_select(i, N):
    idx = list(range(N))
    idx.pop(i)
    return np.random.choice(idx)

def bound_check(x, LB, UB):
    return np.minimum(np.maximum(x, LB), UB)

# === Chaotic Local Search (CLS) ===
def CLS(best_x, best_f, pop, fobj, LB, UB, L, it=None):
    r = 4.0
    xch = np.random.rand()
    N, _ = pop.shape
    for _ in range(L):
        xch = r * xch * (1 - xch)
        cf = xch - 0.5
        i1, i2 = np.random.choice(N, size=2, replace=False)
        xi, xj = pop[i1], pop[i2]
        cand = best_x + cf * (xi - xj)
        cand = bound_check(cand, LB, UB)
        fc = fobj(cand, it)
        if fc < best_f:
            best_x, best_f = cand, fc
    return best_x, best_f

# === COCSOS ===
def COCSOS(N, MaxIt, LB, UB, dim, fobj, Ifmax):
    LB = np.array(LB).reshape(dim,)
    UB = np.array(UB).reshape(dim,)

    # Initialize population
    Position = initialization(N, dim, UB, LB)
    Position = apply_CO(Position, 0, MaxIt, LB, UB)

    # Initial fitness
    Fitness = np.array([fobj(Position[i], 1) for i in range(N)])

    # Initialize best and worst
    ord0 = np.argsort(Fitness)
    Best_Score = Fitness[ord0[0]]
    Best_Pos = Position[ord0[0]].copy()
    # Convergence curve
    CG_curve = np.zeros(MaxIt)

    for it in range(1, MaxIt+1):
        # ===== Mutualism Phase =====
        for i in range(N):
            j = random_select(i, N)
            mutual = 0.5 * (Position[i] + Position[j])
            bf = np.random.randint(1, 3, size=2)  

            # Individual i
            new_i = Position[i] + np.random.rand() * (Best_Pos - bf[0] * mutual)
            new_i = bound_check(new_i, LB, UB)
            fi = fobj(new_i, it)
            if fi < Fitness[i]:
                Position[i], Fitness[i] = new_i, fi

            # Individual j
            new_j = Position[j] + np.random.rand() * (Best_Pos - bf[1] * mutual)
            new_j = bound_check(new_j, LB, UB)
            fj = fobj(new_j, it)
            if fj < Fitness[j]:
                Position[j], Fitness[j] = new_j, fj

        # ===== Commensalism Phase =====
            j = random_select(i, N)
            rvec = 2 * np.random.rand(dim) - 1
            new_i = Position[i] + rvec * (Best_Pos - Position[j])
            new_i = bound_check(new_i, LB, UB)
            fi = fobj(new_i, it)
            if fi < Fitness[i]:
                Position[i], Fitness[i] = new_i, fi

        # ===== Parasitism Phase =====
            host = random_select(i, N)
            parasite = Position[i].copy()
            n_changes = int(np.ceil(np.random.rand() * dim))
            idxs = np.random.choice(dim, n_changes, replace=False)
            parasite[idxs] = LB[idxs] + np.random.rand(n_changes) * (UB[idxs] - LB[idxs])
            fp = fobj(parasite, it)
            if fp < Fitness[host]:
                Position[host], Fitness[host] = parasite, fp

        # ===== Opposition Phase (CO) =====
        #### Jr
        if np.random.rand() < 0.2:
            pop2 = apply_CO(Position, it, MaxIt, LB, UB)
            both = np.vstack((Position, pop2))
            fit2 = np.array([fobj(ind, it) for ind in both])
            sel = np.argsort(fit2)[:N]
            Position = both[sel]
            Fitness = fit2[sel]

        # Update best and worst
        idx_min = np.argmin(Fitness)
        fmin = Fitness[idx_min]
        if fmin < Best_Score:
            Best_Score, Best_Pos = fmin, Position[idx_min].copy()

        # ===== Chaotic Local Search =====
        #### Local search limit
        cand, cfit = CLS(Best_Pos.copy(), Best_Score, Position, fobj, LB, UB, 30, it)
        if cfit < Best_Score:
            Best_Pos, Best_Score = cand.copy(), cfit
            widx = np.argmax(Fitness)
            Position[widx], Fitness[widx] = Best_Pos.copy(), Best_Score

        # ===== Ifmax Adjustment =====
        half = dim // 2
        blocks = len(Ifmax) // half
        for ii in range(half):
            if all(Ifmax[ii + jj*half] == 0 for jj in range(blocks)):
                Best_Pos[ii] = 0
        Best_Score = fobj(Best_Pos, it)

        CG_curve[it-1] = Best_Score
        if it % 10 == 0:
            print(f"Iteration {it}: Best Fitness = {Best_Score}")

    return Best_Score, Best_Pos, CG_curve

# === Group-based COCSOS ===
def COCSOS_group(N, MaxIt, LB, UB, dim, fobj):
    # ensure LB/UB are 1D numpy arrays
    LB = np.array(LB, dtype=float).reshape(dim,)
    UB = np.array(UB, dtype=float).reshape(dim,)

    # Initialize population
    pop = np.random.rand(N, dim) * (UB - LB) + LB
    pop = apply_CO(pop, 0, MaxIt, LB, UB)

    # Evaluate initial fitness
    fitness = np.array([fobj(pop[i]) for i in range(N)])

    # Initialize best and worst
    idx_min = np.argmin(fitness)
    Best_Score = fitness[idx_min]
    Best_Pos = pop[idx_min].copy()
    # Convergence curve
    CG_curve = np.zeros(MaxIt)

    for it in range(1, MaxIt+1):
        # --- Mutualism phase ---
        for i in range(N):
            j = random_select(i, N)
            mutual = 0.5 * (pop[i] + pop[j])
            bf = np.random.randint(1, 3, size=2) 

            for k, idx in enumerate((i, j)):
                r = np.random.rand()
                candidate = pop[idx] + r * (Best_Pos - bf[k] * mutual)
                candidate = bound_check(candidate, LB, UB)
                fval = fobj(candidate)
                if fval < fitness[idx]:
                    pop[idx] = candidate
                    fitness[idx] = fval

        # --- Commensalism phase ---
            j = random_select(i, N)
            r_vec = 2 * np.random.rand(dim) - 1
            candidate = pop[i] + r_vec * (Best_Pos - pop[j])
            candidate = bound_check(candidate, LB, UB)
            fval = fobj(candidate)
            if fval < fitness[i]:
                pop[i] = candidate
                fitness[i] = fval

        # --- Parasitism phase ---
            host = random_select(i, N)
            parasite = pop[i].copy()
            n_changes = int(np.ceil(np.random.rand() * dim))
            idxs = np.random.choice(dim, n_changes, replace=False)
            parasite[idxs] = LB[idxs] + np.random.rand(n_changes) * (UB[idxs] - LB[idxs])
            fpar = fobj(parasite)
            if fpar < fitness[host]:
                pop[host] = parasite
                fitness[host] = fpar

        # --- Opposition phase (CO) ---
        #### Jr
        if np.random.rand() < 0.2:
            pop2 = apply_CO(pop, it, MaxIt, LB, UB)
            both = np.vstack((pop, pop2))
            fit_all = np.array([fobj(ind) for ind in both])
            sel = np.argsort(fit_all)[:N]
            pop = both[sel]
            fitness = fit_all[sel]

        # Update global best/worst
        idx_min = np.argmin(fitness)
        if fitness[idx_min] < Best_Score:
            Best_Score = fitness[idx_min]
            Best_Pos = pop[idx_min].copy()

        # --- Chaotic Local Search around Best_Pos ---
        #### Tham số 
        Best_Pos, Best_Score = CLS(Best_Pos.copy(), Best_Score, pop, fobj, LB, UB, 30)

        # Record convergence
        CG_curve[it-1] = Best_Score
        if it % 100 == 0:
            print(f"Iteration {it}: Best = {Best_Score:.6g}")

    return Best_Score, Best_Pos, CG_curve
# === Optimization Wrapper ===
def Optimization(Population, MaxIt, Ifmax, Ifmin, Ikd,
                 relay_main, I_coor_main, relay_back, I_coor_back):

    # dimension = 2 * number of relays
    dim = 2 * len(Ikd)

    # Lower bounds for TMS (first half) and PS pickup (second half)
    LB1 = np.ones(dim // 2) * 0.05
    LB2 = np.array(Ikd, dtype=float)
    LB  = np.concatenate([LB1, LB2])

    # Upper bounds for TMS
    UB1 = np.ones(dim // 2) * 2
#### COEFFS - Ty so CT
    # coeffs = np.array([240, 240, 160, 240, 240, 240, 160,
    #                    240, 160, 240, 240, 240, 240, 160], dtype=float)
    coeffs = np.array([160,  240,	160,	240,	160,    120,	120,	240,	120,	160,	
                       240,	 240,	160,	240,	240,	120,	80, 	320,	160,	320,
                       320,	 80,	240,	120,	120,	120,	120,	120,	320,	80,
                       120,	 120,	120,	80, 	120,	160,	160,	80,	    80,	    160,
                        80,	160], dtype=float)
    UB2 = np.minimum(np.array(Ifmin, dtype=float) / 240.0, 10.0) * (coeffs / 240.0)

    UB = np.concatenate([UB1, UB2])

    # Objective function wrapper
    fobj = lambda x, it=None: OF(
        x, it,
        Ifmax,
        relay_main, I_coor_main,
        relay_back, I_coor_back,
        MaxIt,
        coeffs 
    )

    # Call the core NRBO optimizer
    Best_Score, Best_Pos, CG_curve = COCSOS(
        Population,
        MaxIt,
        LB,
        UB,
        dim,
        fobj,
        Ifmax
    )

    return Best_Score, Best_Pos, CG_curve

# === Core grouping function ===
def grouping_function(GroupName, Population, MaxIt, ngroup):
    # 1) Làm tròn nhãn nhóm
    GroupName = np.round(GroupName).astype(int)

    # 2) Khởi tạo kết quả
    Best_Score   = np.zeros(ngroup, dtype=float)
    Best_Pos_all = [np.zeros(2 * nrelay, dtype=float) for _ in range(ngroup)]

    # 3) Lặp qua từng nhóm
    for i in range(1, ngroup+1):
        # Tập chỉ số bus thuộc nhóm i
        members = np.where(GroupName == i)[0]

        # Khởi tạo các mảng dữ liệu cho nhóm
        Ifmax = []  
        Ifmin = np.full_like(Ifmin_all[0], np.inf, dtype=float)
        Ikd   = np.zeros_like(Ifmin_all[0], dtype=float)
        relay_main   = []
        I_coor_main  = []
        relay_back   = []
        I_coor_back  = []

        # Gom dữ liệu từ từng bus trong nhóm
        for idx in members:
            # cập nhật Ikd lớn nhất
            Ikd = np.maximum(Ikd, Ifmin_all[idx])

            # tính Ifmin theo công thức và loại bỏ giá trị 0
            mask = np.array(Ifmax_all[idx], dtype=float)
            mask[mask == 0] = 99999
            Ifmin = np.minimum(Ifmin, mask) * (np.sqrt(3)/2)

            # mở rộng Ifmax và các danh sách relay
            Ifmax.extend(Ifmax_all[idx])
            relay_main.extend(relay_main_all[idx])
            I_coor_main.extend(I_coor_main_all[idx])
            relay_back.extend(relay_back_all[idx])
            I_coor_back.extend(I_coor_back_all[idx])

        score_i, pos_i,_= Optimization(
            Population, MaxIt, Ifmax, Ifmin, Ikd,
                 relay_main, I_coor_main, relay_back, I_coor_back
        )

        # Lưu kết quả
        Best_Score[i-1]      = score_i
        Best_Pos_all[i-1][:] = pos_i

    # 5) Tính f trung bình trên ntopo
    f = Best_Score.sum() / ntopo

    return f, Best_Score, Best_Pos_all
# === Main ===
if __name__ == '__main__':
    # --- Tham số chung ---
    Population = 5   # pop size cho tối ưu
    MaxItOpt   = 20   # số iter cho tối ưu

    #Population = 50   # pop size cho tối ưu phân cụm
    #MaxItOpt   = 50    # số iter cho tối ưu phân cụm


    N =10               # pop size cho phân cụm
    MaxItGroup = 10     # số iter cho phân cụm

    ngroup     = 6       # số nhóm
    dim_clust  = ntopo   # số topology cần phân cụm

    # --- Giai đoạn 1: Phân cụm bằng nrbo_group ---
    LB_g = np.ones(dim_clust)
    UB_g = np.ones(dim_clust) * ngroup

    # Wrapper chỉ trả về f_group (mục tiêu phân cụm)
    def f_grouping(x_cont, it = None):
        x_int = np.clip(np.round(x_cont).astype(int), 1, ngroup)
        f_group,_,_ = grouping_function(
            x_int,
            Population,   
            MaxItOpt,
            ngroup
        )
        return f_group
### Nếu đổi stage thì note 555-570 + thêm Group name

    # print("=== Stage 1: Clustering (COCSOS_group) ===")
    # score_clust, pos_clust, curve_clust = COCSOS_group(
    #     N,               # cỡ quần thể NRBO_group
    #     MaxIt=MaxItGroup,
    #     LB=LB_g,
    #     UB=UB_g,
    #     dim=dim_clust,
    #     fobj=f_grouping
    # )

    # # Lấy ra GroupName cuối cùng
    # GroupName = np.clip(np.round(pos_clust).astype(int), 1, ngroup)
    # print("Jr=0.2, k=30, N=", ngroup,"\n")
    # print("Best clustering score:", score_clust)
    # print("Group assignments:", GroupName, "\n")
    # running = False
    # thread.join()

    
#### ___________________________________________________________________
    

    ### Timer cho Stage 
    

    ### End Timer cho stage 1

    # GroupName = [4, 2, 2, 1, 2, 4, 3, 2, 1, 4, 1, 4, 4]
#    GroupName = [3, 1, 2, 3, 1, 3, 2, 3, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 3, 3, 3, 2, 2, 2, 3, 3, 3, 3 ] #N=4 #N=4
#    GroupName = [3, 3, 4, 3, 4, 3, 4, 4, 2, 3, 3, 4, 3, 2, 4, 3, 4, 3, 4, 2, 3, 4, 3, 4, 2, 3, 4 ,2 ] #N=5
    GroupName = [4, 5, 5, 3, 2, 2, 2, 3, 4, 6, 4, 5, 5, 2, 6, 4, 4, 4, 5, 6, 5, 4, 3, 5, 4, 2, 6, 4] # 6








    # # --- Giai đoạn 2: Tối ưu từng nhóm bằng NRBO inner ---
    print("=== Stage 2: Per-group Optimization (NRBO) ===")
    (f_final, Best_Score, Best_Pos_all) = grouping_function(
        GroupName,   # vector phân cụm đã tìm
        Population,
        MaxItOpt,
        ngroup
    )
    print("\n=== Detailed Settings and CTI Checks ===")
    # GroupName đã có sẵn ở main
    GroupName = np.array(GroupName, dtype=int)
    final = 0
    total_time =0
    sumKB = 0
    # coeffs = np.array([240, 240, 160, 240, 240, 240, 160,
    #                240, 160, 240, 240, 240, 240, 160], dtype=float)
    
    coeffs = np.array([160,  240,	160,	240,	160,    120,	120,	240,	120,	160,	
                       240,	 240,	160,	240,	240,	120,	80, 	320,	160,	320,
                       320,	 80,	240,	120,	120,	120,	120,	120,	320,	80,
                       120,	 120,	120,	80, 	120,	160,	160,	80,	    80,	    160,
                        80,	160], dtype=float)
    for grp_idx, pos in enumerate(Best_Pos_all, start=1):
        # tách TMS và PS
        nrelay = pos.size // 2
        TMS = pos[:nrelay]
        PS = pos[nrelay:]

        print(f"\n--- Group {grp_idx} ---")
        # 1) In TDS (TMS)
        print("TDS settings (TMS):")
        for r in range(nrelay):
            print(f"  Relay {r+1:>2}: TMS = {TMS[r]:.4f}")
        # 2) In PS
        print("PS settings (pickup):")
        for r in range(nrelay):
            print(f"  Relay {r+1:>2}: PS  = {PS[r]:.4f}")
        # 3) CTI checks
        print("CTI checks per scenario & pair:")
        members = np.where(GroupName == grp_idx)[0]
        for bus in members:
            print(f"  Scenario (bus) {bus+1}:")
            # relay_main_all, relay_back_all, I_coor_main_all, I_coor_back_all là các list toàn cục
            mains = relay_main_all[bus]
            backs = relay_back_all[bus]
            Ims   = I_coor_main_all[bus]
            Ibs   = I_coor_back_all[bus]
            for k, (m, b, Im, Ib) in enumerate(zip(mains, backs, Ims, Ibs), start=1):
                t_main = TMS[m-1] * trip(Im, PS[m-1], coeffs[m-1])
                t_back = TMS[b-1] * trip(Ib, PS[b-1], coeffs[b-1])
                delta  = t_back - t_main
                status = "OK" if delta >= 0.2 else "Violation"
                print(f"    Pair {k:>2}: Main R{m} → Back R{b} | CTI = {delta:.4f}s [{status}]")
            
            print("  Trip times per relay (s):")
            trip_times = []
            for r in range(nrelay):
                If = Ifmax_all[bus][r]
                t_r = TMS[r] * trip(If, PS[r], coeffs[r])
                trip_times.append(t_r)
                print(f"    Relay {r+1:>2}: t = {t_r:.4f}s")
            nonzero = [t for t in trip_times if t > 0]
            if nonzero:
                total_time = sum(nonzero) / len(nonzero)
            else:
                total_time = 0.0
            print(f"  Avg trip time for scenario {bus+1} (nonzero only): {total_time:.4f}s")
            sumKB += total_time
        final = sumKB / ntopo
    # In tiếp kết quả chung
    print("\n=== Final Result === \n")
    print("Jr=0.2, k=30, N=", ngroup,"\n")
    print(f"\nFitness: {final:.6f}\n")
    print(f"\nOverall average fitness: {f_final:.6f}\n")
   
    running = False
    thread.join()
